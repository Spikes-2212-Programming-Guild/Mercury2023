<!DOCTYPE html>
<html lang="en"><title>good form</title>

<meta name="viewport" content="width=device-width, initial-scale=1">
<body style="background-color:rgb(44, 44, 44);text-align: center; align-items: center; align-content: center; display: grid; place-items: center;">

<script>
    let TitlE = new URLSearchParams(window.location.search);
    TitlE = TitlE.get('title')

    let TitlE2 = document.createElement("h1")
    TitlE2.textContent = TitlE
    TitlE2.style.color = "white"
    document.body.appendChild(TitlE2)
</script>


<script src="betterForm.js"></script>
<script src="modifyCookies.js"></script>
<script src="buildLink.js"></script>
<script src="Questions.js"></script>
<script src="pages.js"></script>


<!-- <input type = "text"></input> -->
<script>
let range = new URLSearchParams(window.location.search);
range = range.get('qs').split('q');
console.log(range);

let nextPage = new URLSearchParams(window.location.search);
nextPage = Number(nextPage.get('index'));
console.log(nextPage)

try{
    console.log(getCookieContent("link" + Number(range[1])))
}
catch{
    console.log("not found")
}

buildHTML(Number(range[1]), Number(range[2]))
function buildArr(){
    let arr = [[],[]]
    for(let i = 0; document.getElementById("textBox"+i) != undefined || document.getElementById("textBox"+i+"row"+1) != undefined ;i++){
        arr[i] = []
        if(document.getElementById("textBox"+i) != undefined && document.getElementById("textBox"+i).type == "text"){
            arr[i][0] = document.getElementById("textBox"+i).value
            console.log(arr[i][0])
            createCookie("textbox" + (Number(range[1]) + i),  document.getElementById("textBox"+i).value)

            // createCookie(Questions[i][0], document.getElementById("textBox"+i).value)
            // console.log("new cookie: " + Questions[i][0] + " - " + document.getElementById("textBox"+i).value)
        }
        else{
            for(let j = 1, countor = 0; document.getElementById("textLabel" + i + "row" + j) != undefined && document.getElementById("textLabel" + i + "row" + j) != null ; j++){
                if(document.getElementById("textBox" + i + "row" + j).checked){
                    arr[i][countor] = document.getElementById("textLabel" + i + "row" + j).textContent
                    countor++;
                    createCookie("checkq" + (Number(range[1]) + i) + "num" + (9*i+j) ,true)
                    // createCookie(Questions[i][j], document.getElementById("textLabel"+i+"row"+j).value)
                    // console.log("new cookie: " + Questions[i][0] + " - " + document.getElementById("textLabel"+i+"row"+j).value)
                }
                console.log(document.getElementById("textLabel" + i + "row" + j).textContent)
                console.log(document.getElementById("textBox" + i + "row" + j).checked)
                //console.log(arr[i][j])
            }
            // arr[i][0] = document.getElementById("textLabel" + i + "row" + 1).textContent
            // console.log(arr[i][0])
        }
        //console.log(document.getElementById("textBox"+i).type)
    }
    console.log(arr)
    
    createCookie(("link" + Number(range[1])) , fillFromArray(Number(range[1]), arr))
    
}

function goforward(){
    buildArr()
    // if(getPages().length > nextPage){
    //     //window.open(getPages()[nextPage] + '&index=' + (nextPage+1))
    //     window.location.href = getPages()[nextPage] + '&index=' + (nextPage+1)
    // }
    //window.close()
    if (getPages().length > nextPage) {
        window.location.href = getPages()[nextPage] + '&index=' + (nextPage+1)
    }
    else{
        window.location.href = 'index.html'
    }
}

function goback(){
    buildArr()
    // if(nextPage > 1){
    //     //window.open(getPages()[nextPage-2] + '&index=' + (nextPage-1))
        
    // }
    if (window.history.length === 1) {
        window.close();
    }
    else {
        window.history.back();
    }
    //window.close()
}

</script>
&ensp;
<button onclick="goforward()" id="saveButton" style="width: 45%; height: 50px; background-color: rgb(0, 199, 90); border-color: rgb(0, 131, 39); color: rgb(255, 255, 255); font-size: large; margin: 0 auto; display: inline-block;">Next</button>
<button onclick="goback()" id="saveButton" style="width: 45%; height: 50px; background-color: rgb(0, 199, 90); border-color: rgb(0, 131, 39); color: rgb(255, 255, 255); font-size: large; margin: 0 auto; display: inline-block;">Back</button>
</body></html>
